###############################################################################
# marc_local.properties -- local overrides to standard VuFind MARC mappings.  #
#                          All settings in this file override equivalent      #
#                          settings in marc.properties.                       #
###############################################################################

# bib number, without check digit
id = 935a[0-8], first
# Suppressed record suppression
suppressed = 999f, (map.delete_record_map), DeleteRecordIfFieldEmpty
map.delete_record_map.d = null
map.delete_record_map.n = null
map.delete_record_map.p = null
map.delete_record_map.w = null
map.delete_record_map = keep

collection  = 999a:992b, institution_collections.properties(collection_port1)
collection_temp = 999e, collectiontypes.properties(collection_port2)
collection_tmp2 = 999e, collectiontypes2.properties(collection_port3)
collection_tmp3 = 999f, collections.properties(collection_port4)
institution = 999a:992b, location.properties(port)

# Local Trico customized facets
topic_facet = 600x:610x:611x:630x:650a:650x:651x:655x
genre_facet = script(genrefilter.bsh), getGenres
geographic_facet = 600z:610z:611z:630z:650z:651a:651z:655z
author_facet = 100abcdq:400abcd:505r:700abcdq:800abcdq:970f
series_facet = 440ap:800abcdfpqt:830ap

url = 856uz3
isbn = 020a
publisher = script(tricopub.bsh), getPublishers
language = script(languagefilter.bsh), getLanguages, language_map.properties

# Local Trico Author Sorting index
authorSort = 100abcd, first

# callnumber is used for searching and sorting
callnumber = custom, getFullCallNumber(090ab)
# callnumber-a is used to build the alphabrowse index
callnumber-a = 090a first
# the rest of these are used for faceting
callnumber-first = 099a[0]:090a[0]:050a[0]:949i[0], callnumber_map.properties, first
callnumber-first-code = 099a[0]:090a[0]:050a[0]:949i[0], first
callnumber-subject = custom, getCallNumberSubject(090a:050a:949i), callnumber_subject_map.properties
callnumber-subject-code = custom, getCallNumberSubject(090a:050a:949i)
callnumber-label = custom, getCallNumberLabel(090a:050a:949i)
# new trico callnumber fields for searching, sorting
callnumber-lc-sort = script(tricolccn.bsh), getSortLccn(090)
callnumber-lc-search = script(tricolccn.bsh), getSearchLccns(090)

# title indexing to clean up punctuation
title = custom, removeTrailingPunct(245ab)
title_short = custom, removeTrailingPunct(245a)
title_sub = custom, removeTrailingPunct(245b)
# just the punctuation from 245h
# this regex was broken; moving it to RecordDriver/SolrMarc.php ah 2014-06-04
#title_medium = 245h, title_subfieldh.properties(punct), first

# no longer indexing non-title data in the 245 for search relevance
title_full = custom, removeTrailingPunct(245abnp)

# removed 130 and 240 from title_alt since we gave them their own index
title_alt = 242abc:246abnp:730adfgklmnoprst:740anp
title_uniform = 130adfgklmnoprst:240adfgklmnoprs

# indexing for previous title
# inserts a pipe between each subfield to make breaking apart and recombining subfields possible
title_former = custom, getAllSubfields(247[a-z], "|")

#for display of additional edition fields
tricoedition = 250a:254a

# indexes for search that partially match Tripod's indexes. May need to add more subfields.
title_former_search = 247abnp
title_abbrev = 210ab:211a:212a
title_series = 400npt:400.1npt:410npt:410.1npt:411npt:411.1npt:440n:490a:800n:810npt:811npt:830p:840a
title_content = 505t
title_added = 700npt:710pt:711pt:100npt:110npt:111npt
title_related = 787tb
title_old_search = 780tb
title_new_search = 785tb
title_host = 773st
title_toc = 970t
author = 100abcdq
author_fuller = 100q:111q:400q:411q:700q:711q:800q:811q
author2 = 110ab:111ab:400abcd:410ab:411ab:700abcd:710ab:711ab:800abcdq:810ab:811ab:970f
author_host = 773a
author_toc = 970df
genre = custom, getAllSubfields(655:755, " ")
topic = custom, getAllSubfields(600:610:611:630:650:690:691:692:693:694:695, " ")

physical = 300abcefg:530abcd:533abcdefmn35
series = 440ap:800abcdfpqt:810at:830ap
#cartographic_data = 255abcdefg

# Trico date indices
sortDate = script(tricodate.bsh), getSortDate
facetDate = script(tricodate.bsh), getFacetDate
publishDate = script(tricodate.bsh), getDisplayDate

format = 999e, iiiformat.properties
contents = 505a:505t:970ltpf
author_additional = 505r:970f:245c

# Uncomment the following settings to use the .bsh scripts in import/scripts/
# instead of the built-in SolrMarc functionality found in the .jar file.
# (by default, the scripts have the same behavior as the built-in functions,
# but the external scripts are easier to customize to your needs).
#format = script(format.bsh), getFormat, format_map.properties
#callnumber = script(callnumber.bsh), getFullCallNumber(099ab:090ab:050ab)
#callnumber-subject = script(callnumber.bsh), getCallNumberSubject(090a:050a), callnumber_subject_map.properties
#callnumber-subject-code = script(callnumber.bsh), getCallNumberSubject(090a:050a)
#callnumber-label = script(callnumber.bsh), getCallNumberLabel(090a:050a)
#publishDate = script(getdate.bsh), getDate
#illustrated = script(illustrated.bsh), isIllustrated
#dewey-hundreds = script(dewey.bsh), getDeweyNumber(082a:083a, 100), ddc22_map.properties(hundreds)
#dewey-tens = script(dewey.bsh), getDeweyNumber(082a:083a, 10), ddc22_map.properties(tens)
#dewey-ones = script(dewey.bsh), getDeweyNumber(082a:083a, 1), ddc22_map.properties(ones)
#dewey-full = script(dewey.bsh), getDeweySearchable(082a:083a)
#dewey-sort = script(dewey.bsh), getDeweySortable(082a:083a)

# Uncomment the following lines to track history of indexing times for RSS feeds,
# OAI-PMH server and other updates.  The parameter to these functions must be the 
# same fieldspec as the id setting above!
# IMPORTANT: Indexing this extra information will make extra database calls during
#            the indexing process and will likely slow things down significantly.
#first_indexed = custom, getFirstIndexed(001)
#last_indexed = custom, getLastIndexed(001)

# Uncomment the following line to index full text from URLs found in your MARC
# records.  All sorts of document formats are supported (PDF, Word Doc, ASCII
# text, HTML, etc.) The first parameter is a fieldspec showing which fields to use
# for URL retrieval.  The second parameter is optional -- if included, only files
# matching the specified suffix will be indexed.  Note that this functionality
# depends on a full text tool being installed on your system.  See the wiki for
# details:
#       http://vufind.org/wiki/importing_records#indexing_full_text
#fulltext = custom, getFulltext(856u, pdf)

# Uncomment the following line if you want to index latitude/longitude data for
# Google Map recommendations:
#long_lat = custom, getLongLat

# Uncomment the following lines if you are indexing journal article data that uses
# the 773 field to describe the journal containing the article.  These settings
# assume the records have been formatted according to recommendation 4.1 found at:
#     http://www.loc.gov/marc/marbi/2003/2003-dp01.html
# If you have records using a different 773 format, you may need to write a custom
# indexing script to parse out volume/issue/number.
# Additionally, you will need to make sure articles have a format value of "Article."
# You can hard-code this if all of your records are articles, but if you need to
# distinguish between articles and non-articles, you will need to build a custom
# getFormat script.
#format = "Article"
#container_volume = 773v
#container_issue = 773l
#container_start_page = 773q
#container_reference = 773g
#container_title = 773s
